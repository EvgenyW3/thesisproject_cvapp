<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
 	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
	<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <!-- Bootstrap slider js and css -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.5.4/bootstrap-slider.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/9.5.4/css/bootstrap-slider.min.css">
	<!-- Font-awsome -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
	<!-- My custom css -->
    <link rel='stylesheet' href='/stylesheets/custom.css' />
    <title>{{title}}</title>
  </head>
  <body>
  	<div class="wrapper">
		<div class="row label-row">
      {{> sidebar}}
        <div class="col-sm-9 main">
          {{> navigation}}
          <div class="wrapper-padding">
            {{> modal}}
            {{{body}}}
          </div>
        </div>
    	</div>
    </div>
    <script>
        //This is for hover effect for arrow when it is triggered to download button
    $("#hover").hover(function(){
      $("#level-down").css({
        color: "#01a69a",
        WebkitTransition : '.5s',
          MozTransition    : '.5s',
          MsTransition     : '.5s',
          OTransition      : '.5s',
          transition       : '.5s'
      });
    }, function(){
      $("#level-down").css({
        color: "#eeeeee"
      });
    }
    );
    </script>
    <script>
        //This is for job's description show/hide
    var i = 0;
    for(let l = 0; l < {{page.expirience.length}}; l++) {
        $("#j"+l).click(function () {
            if (i++ % 2 === 0) {
                $("#job"+l).hide("slow");
                $("#j"+l).removeClass('fa-minus-square');
                $("#j"+l).addClass('fa-plus-square');
            } else {
                $("#job"+l).show("slow");
                $("#j"+l).removeClass('fa-plus-square');
                $("#j"+l).addClass('fa-minus-square');
            }
        });
    }
        //This is for school's description show/hide
    var s = 0;
    for(let i = 0; i < {{page.education.length}}; i++) {
        $("#s" + i).click(function () {
            if (s++ % 2 === 0) {
                $("#school" + i).hide("slow");
                $("#s" + i).removeClass('fa-minus-square');
                $("#s" + i).addClass('fa-plus-square');
            } else {
                $("#school" + i).show("slow");
                $("#s" + i).removeClass('fa-plus-square');
                $("#s" + i).addClass('fa-minus-square');
            }
        });
    }
    </script>
    <script>
    //fixed nav and dropdown
    //Also small correction to wrapper-padding
    $(document).ready(function() {

      $(window).scroll(function () {
      
          console.log($(window).scrollTop())
        
        if ($(window).scrollTop() > 394) {
          $('#nav').addClass('nav-fixed-responsive');
          $('#navv').addClass('dropdown-fixed-responsive');
          $(".wrapper-padding").css("paddingTop", "92px");
        }
        if ($(window).scrollTop() < 395) {
          $('#nav').removeClass('nav-fixed-responsive');
          $('#navv').removeClass('dropdown-fixed-responsive');
          $(".wrapper-padding").css("paddingTop", "50px");
        }
      });
    });
    </script>
    <script>
        //This is for dropdown menu toggle on small screensize
    var d = 0;
    $("#dropdown").click(function(){
      if(d++ % 2 === 0){
        $("#dropdown-toggle").show("slow");
        $("#dropdown").removeClass('fa-bars');
        $("#dropdown").addClass('fa-times');
      }else{
        $("#dropdown-toggle").hide("slow");
        $("#dropdown").removeClass('fa-times');
        $("#dropdown").addClass('fa-bars');
      }
    });
    </script>
    <script>
    //This is for adding new skill group
    var i = {{page.skills.length}};
      $("#group").click(function(){
        $('#skill-group').append(
          '<hr>'+
          '<div id="group'+ i + '">'+
          '<div class="form-group">'+
                '<label for="skills.title">Skill group name</label>'+
                '<input type="text" class="form-control" name="skills['+i+'][title]" placeholder="Skill group name" id="input'+i+'">'+
            '</div>'+
            '<div class="form-group">'+
                '<button type="button" class="btn btn-primary" id="skill" data="'+ i +'">Add skill</button>'+
          '</div>'+
          '</div>'
        );
        i++;
      });
    //This is for adding new skill to existing group
    //Delegated on click is used, because button was dynamicly added

    //Explanation below
    var j = {{page.skills.1.skills.length}};
      $("#skill-group").on('click', '#skill', function(){
    	//For some reason I need to increase j variable here, because otherwise slider doesn't work
    	//But we need to fill [0] place of the array, thats why j variable starts at (-1) and not from 0
        j++;
        for(var l = i; l >= 0; l--){
          if($(this).attr("data") == l){
            $('#group'+l).append(
              '<div class="form-group">'+
                  '<label for="skills.skill.skillName">Skill name</label>'+
                  '<input type="text" class="form-control" name="skills['+l+'][skills]['+j+'][skillName]" placeholder="Skill name">'+
              '</div>'+
              '<div class="form-group">'+
                  '<label for="skills.skill.mastery">Skill mastery</label>'+
                  '<br>'+
                  '<input type="text" id="ext'+ j +'" data-slider-id="ex1Slider" data-slider-min="0" data-slider-max="100" data-slider-step="1" data-slider-value="0" name="skills['+l+'][skills]['+j+'][mastery]">'+
              '</div>'
            );
          
          }
        }
      //This one we need for reloading our slider plugin otherwise we see no sliders
      $("#ext"+j).slider({
        formatter: function(value) {
          return 'Current value: ' + value + '%';
        }
        });
      });
    </script>
    <script>
    var n = {{page.expirience.length}};
    //This is for adding new job
      $("#job").click(function(){
        $('#exp').append(
          '<hr>'+
          '<div class="form-group">'+
                '<label for="expirience.employerName">Employer name</label>'+
                '<input type="text" class="form-control" name="expirience['+n+'][employerName]" placeholder="Employer name">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="expirience.position">Position</label>'+
                '<input type="text" class="form-control" name="expirience['+n+'][position]" placeholder="Position">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="expirience.date">Date</label>'+
                '<input type="text" class="form-control" name="expirience['+n+'][date]" placeholder="mm.yyyy - mm.yyyy">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="expirience.explanation">Description</label>'+
                '<textarea rows="5" class="form-control" name="expirience['+n+'][explanation]" placeholder="Description" />'+
            '</div>'
        );
        n++;
      });
    </script>
    <script>
    var g = {{page.education.length}};
    //This is for adding new school
      $("#school").click(function(){
        $('#education').append(
          '<hr>'+
          '<div class="form-group">'+
                '<label for="education.schoolName">School name</label>'+
                '<input type="text" class="form-control" name="education['+g+'][schoolName]" placeholder="School name">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="education.programmeName">Programme</label>'+
                '<input type="text" class="form-control" name="education['+g+'][programmeName]" placeholder="Programme">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="education.date">Date</label>'+
                '<input type="text" class="form-control" name="education['+g+'][date]" placeholder="mm.yyyy - mm.yyyy">'+
            '</div>'+
            '<div class="form-group">'+
                '<label for="education.explanation">Description</label>'+
                '<textarea rows="5" class="form-control" name="education['+g+'][explanation]" placeholder="Description" />'+
            '</div>'
        );
        g++;
      });
    </script>
    <script>
        //This is for setting form action depending of button's value
        //And the button's value depends of an answer from server when it checks db for page collections
      $('#form').on('submit', function(){
        var check = $('#modalTrigger').val();
        console.log(check);
        if(check === 'Create resume'){
          $(this).attr('action', 'create');
        }else{
          $(this).attr('action', 'update');
        }
      })
    </script>
  </body>
</html>
